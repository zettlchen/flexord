<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>FlexMix Driver for Regularized Multinomial Mixtures — FLXMCregmultinom • flexord</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="FlexMix Driver for Regularized Multinomial Mixtures — FLXMCregmultinom"><meta property="og:description" content="This model driver can be used to cluster data using a multinomial
distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexord</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Intro2Flexord.html">Introduction to Flexible Clustering of (Mixed-With-)Ordinal Data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dernst/flexord/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>FlexMix Driver for Regularized Multinomial Mixtures</h1>
    <small class="dont-index">Source: <a href="https://github.com/dernst/flexord/blob/HEAD/R/flxregmultinom.R" class="external-link"><code>R/flxregmultinom.R</code></a></small>
    <div class="hidden name"><code>FLXMCregmultinom.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This model driver can be used to cluster data using a multinomial
distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FLXMCregmultinom</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span>, r <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>A formula which is interpreted relative to the
formula specified in the call to <code><a href="https://rdrr.io/pkg/flexmix/man/flexmix.html" class="external-link">flexmix::flexmix()</a></code> using
<code><a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">stats::update.formula()</a></code>. Only the left-hand side (response)
of the formula is used. Default is to use the original model
formula specified in <code><a href="https://rdrr.io/pkg/flexmix/man/flexmix.html" class="external-link">flexmix::flexmix()</a></code>.</p></dd>


<dt>r</dt>
<dd><p>Number of different categories. Values are assumed to be
integers in <code>1:r</code>. Default <code>NULL</code> implies that the number of
different categories is inferred columnwise by the maximum
value observed.</p></dd>


<dt>alpha</dt>
<dd><p>A non-negative scalar acting as regularization
parameter. Can be regarded as adding <code>alpha</code> observations equal
to the population mean to each component.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"FLXC"</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Using a regularization parameter <code>alpha</code> greater than zero
acts as adding <code>alpha</code> observations conforming to the population
mean to each component. This can be used to avoid degenerate
solutions. It also has the effect
that clusters become more similar to each other the larger
<code>alpha</code> is chosen. For small values it is mostly negligible however.</p>
<p>For regularization we compute the MAP estimates for the multinomial
distribution using the Dirichlet distribution as prior, which is
the conjugate prior. The parameters of this prior are selected to
correspond to the marginal distribution of the variable across all
observations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Galindo Garre, F, Vermunt, JK (2006).  <em>Avoiding
Boundary Estimates in Latent Class Analysis by Bayesian
Posterior Mode Estimation</em> Behaviormetrika, 33, 43-59.  -
Ernst, D, Ortega Menjivar, L, Scharl, T, Grün, B (2025).
<em>Ordinal Clustering with the flex-Scheme.</em> Austrian Journal of
Statistics. <em>Submitted manuscript</em>.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"flexmix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dernst/flexord" class="external-link">"flexord"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"flexclust"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0xdeaf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample data</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>     <span class="co"># nr of clusters</span></span></span>
<span class="r-in"><span><span class="va">nvar</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># nr of variables</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, size<span class="op">=</span><span class="va">nvar</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># nr of categories</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>   <span class="co"># obs. per cluster</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># random probabilities per component</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>, \<span class="op">(</span><span class="va">ki</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nvar</span>, <span class="fl">0.01</span>, <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample data by drawing from a binomial distribution with size = r - 1</span></span></span>
<span class="r-in"><span><span class="co"># values are expect values to lie inside 1:r hence we add +1.</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">probs</span>, \<span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">p_i</span>, <span class="va">r_i</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">r_i</span>, <span class="va">p_i</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">}</span>, <span class="va">p</span>, <span class="va">r</span><span class="op">-</span><span class="fl">1</span>, SIMPLIFY<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, args<span class="op">=</span><span class="va">_</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, args<span class="op">=</span><span class="va">_</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">true_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cluster without regularization</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/stepFlexmix.html" class="external-link">stepFlexmix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">~</span><span class="fl">1</span>, model<span class="op">=</span><span class="fu">FLXMCregmultinom</span><span class="op">(</span>r<span class="op">=</span><span class="va">r</span>, alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, k<span class="op">=</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : * * *</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cluster with regularization</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/stepFlexmix.html" class="external-link">stepFlexmix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">~</span><span class="fl">1</span>, model<span class="op">=</span><span class="fu">FLXMCregmultinom</span><span class="op">(</span>r<span class="op">=</span><span class="va">r</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, k<span class="op">=</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : * * *</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Both models are mostly able to reconstruct the true clusters (ARI ~ 0.95)</span></span></span>
<span class="r-in"><span><span class="co"># (it's a very easy clustering problem)</span></span></span>
<span class="r-in"><span><span class="co"># Small values for the regularization don't seem to affect the ARI (much)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/flexclust/man/randIndex.html" class="external-link">randIndex</a></span><span class="op">(</span><span class="fu">clusters</span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="va">true_clusters</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ARI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9933165 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/flexclust/man/randIndex.html" class="external-link">randIndex</a></span><span class="op">(</span><span class="fu">clusters</span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>, <span class="va">true_clusters</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ARI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9867009 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lena Ortega Menjivar, Dominik Ernst.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

