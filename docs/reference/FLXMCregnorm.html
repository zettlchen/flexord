<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>FlexMix Driver for Regularized Multivariate Normal Mixtures — FLXMCregnorm • flexord</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="FlexMix Driver for Regularized Multivariate Normal Mixtures — FLXMCregnorm"><meta property="og:description" content="This model driver implements the regularization method as
introduced by Fraley and Raftery (2007) for univariate normal
mixtures. Default parameters for the regularization according to
that paper may be obtained using FLXMCregnorm_defaults(). We
extend this to the multivariate case assuming independence between
variables within components, i.e., we only implement the special
case where the covariance matrix is diagonal. For more general
applications of normal mixtures see package mclust."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexord</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Intro2Flexord.html">Introduction to Flexible Clustering of (Mixed-With-)Ordinal Data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dernst/flexord/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>FlexMix Driver for Regularized Multivariate Normal Mixtures</h1>
    <small class="dont-index">Source: <a href="https://github.com/dernst/flexord/blob/HEAD/R/flxregnorm.R" class="external-link"><code>R/flxregnorm.R</code></a></small>
    <div class="hidden name"><code>FLXMCregnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This model driver implements the regularization method as
introduced by Fraley and Raftery (2007) for univariate normal
mixtures. Default parameters for the regularization according to
that paper may be obtained using <code><a href="FLXMCregnorm_defaults.html">FLXMCregnorm_defaults()</a></code>. We
extend this to the multivariate case assuming independence between
variables within components, i.e., we only implement the special
case where the covariance matrix is diagonal. For more general
applications of normal mixtures see package <span class="pkg">mclust</span>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FLXMCregnorm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">params</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>A formula which is interpreted relative to the formula
specified in the call to <code><a href="https://rdrr.io/pkg/flexmix/man/flexmix.html" class="external-link">flexmix::flexmix()</a></code> using
<code><a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">stats::update.formula()</a></code>. Only the left-hand side (response)
of the formula is used. Default is to
use the original model formula specified in <code><a href="https://rdrr.io/pkg/flexmix/man/flexmix.html" class="external-link">flexmix::flexmix()</a></code>.</p></dd>


<dt>params</dt>
<dd><p>Prior parameters for normal mixtures. You may obtain
default values according to Fraley and Raftery (2007) using
<code><a href="FLXMCregnorm_defaults.html">FLXMCregnorm_defaults()</a></code>.
As the prior depends on the number of components it is probably not
advisable to run <code>stepFlexmix</code> with more than one value of <code>k</code> at
a time.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"FLXC"</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For the regularization the conjugate prior distributions for the
normal distribution are used, which are:</p><ul><li><p>Normal prior with parameter <code>mu_p</code> and <code>sigma^2/kappa_p</code> for the mean.</p></li>
<li><p>Inverse Gamma prior with parameters <code>nu_p/2</code> and <code>zeta_p^2/2</code> for the
variance.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Ernst, D, Ortega Menjivar, L, Scharl, T, Grün, B (2025).
<em>Ordinal Clustering with the flex-Scheme.</em>
Austrian Journal of Statistics. <em>Submitted manuscript</em>.</p></li>
<li><p>Fraley, C, Raftery, AE (2007)
<em>Bayesian Regularization for Normal Mixture Estimation and Model-Based Clustering.</em>
Journal of Classification, 24(2), 155-181</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>FLXMCregnorm_defaults</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"flexmix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dernst/flexord" class="external-link">"flexord"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"flexclust"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/modeltools/man/ModelEnv-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">iris</span>, select<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cluster one model with a scale parameter similar to the default for 3 components</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="FLXMCregnorm_defaults.html">FLXMCregnorm_defaults</a></span><span class="op">(</span><span class="va">my_iris</span>, zeta_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.23</span>, <span class="fl">0.06</span>, <span class="fl">1.04</span>, <span class="fl">0.19</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/stepFlexmix.html" class="external-link">stepFlexmix</a></span><span class="op">(</span><span class="va">my_iris</span> <span class="op">~</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">3</span>, </span></span>
<span class="r-in"><span>    model<span class="op">=</span><span class="fu">FLXMCregnorm</span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : * * *</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stepFlexmix(my_iris ~ 1, model = FLXMCregnorm(params = params), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     k = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        prior size post&gt;0 ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.1 0.383   71    150 0.473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.2 0.275   29    150 0.193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.3 0.343   50    150 0.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -683.2037 (df=26)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 1418.407   BIC: 1496.684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rand index of clusters vs species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/flexclust/man/randIndex.html" class="external-link">randIndex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/modeltools/man/Generics.html" class="external-link">clusters</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ARI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6311837 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cluster one model with default scale parameter</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="FLXMCregnorm_defaults.html">FLXMCregnorm_defaults</a></span><span class="op">(</span><span class="va">my_iris</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/stepFlexmix.html" class="external-link">stepFlexmix</a></span><span class="op">(</span><span class="va">my_iris</span> <span class="op">~</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="fu">FLXMCregnorm</span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : * * *</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stepFlexmix(my_iris ~ 1, model = FLXMCregnorm(params = params), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     k = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        prior size post&gt;0  ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.1 0.552   94    150 0.6267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.2 0.107    6    146 0.0411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comp.3 0.341   50    150 0.3333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -684.242 (df=26)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 1420.484   BIC: 1498.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rand index of clusters vs species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/flexclust/man/randIndex.html" class="external-link">randIndex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/modeltools/man/Generics.html" class="external-link">clusters</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ARI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5596496 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rand index between both models (should be &gt;= 0.8)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/flexclust/man/randIndex.html" class="external-link">randIndex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/modeltools/man/Generics.html" class="external-link">clusters</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/modeltools/man/Generics.html" class="external-link">clusters</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ARI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6833932 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lena Ortega Menjivar, Dominik Ernst.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

